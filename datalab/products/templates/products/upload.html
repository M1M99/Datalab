<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
    body {
        background-color: darkgray;
        font-family: "Segoe UI", system-ui, sans-serif;
    }
    input {
        padding: 3px 8px;
        border-radius: 3px;
        margin: 5px;
    }
    button {
        border-radius: 5px;
        padding: 5px 17px;
        font-weight: bold;
        background-color: aqua;
        cursor: pointer;
        width: 100px;
        height: 35px;
        margin: 5px;
    }

    .container {
        border: 2px black solid;
        text-align: center;
        width: fit-content;
        margin: 50px auto;
        padding: 10px 20px;
        border-radius: 13px;
        box-shadow: 5px 5px 10px rgba(255, 255, 255);
    }

    .file-group {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    a{
        text-decoration: none;
    }
</style>
<div style="margin-top: 30px;display: flex;align-items: center;gap: 10px">
    <a href="/" style="font-size: 30px"><i class="fas fa-arrow-circle-left"></i></a>
    <a href="{% url 'download_template' %}" style="border: 2px purple solid;border-radius: 5px;padding: 5px 15px"><i class="fas fa-download"></i> Template</a>
</div>
<div class="container">
    <h2>Excel/CSV Upload</h2>
    {% if msg %} <p style="color:green">{{ msg }}</p> {% endif %}
    {% if error %} <p style="color:red">{{ error }}</p> {% endif %}

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div id="file-inputs">
            <div class="file-group">
                <input type="file" name="files" multiple>
                <input type="text" name="sheet_names" placeholder="Sheet (optional)"/>
            </div>
        </div>
        <button type="button" onclick="addFileInput()">Add File</button>
        <button type="submit">Upload</button>
    </form>
</div>

<script>
let fileCount = 1;

function addFileInput() {
    if(fileCount >= 100) {
        alert("Max 100 File!");
        return;
    }
    const container = document.getElementById("file-inputs");
    const div = document.createElement("div");
    div.classList.add("file-group");
    div.innerHTML = `
        <input type="file" name="files" multiple>
        <input type="text" name="sheet_names" placeholder="Sheet (optional)">
    `;
    container.appendChild(div);
    fileCount++;
}
</script>